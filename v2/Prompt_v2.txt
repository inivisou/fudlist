Te voy a pasar un prompt y despuÃ©s te irÃ© pidiendo cosas.

	- Analizalo minuciosamente para que te quede claro que es lo que estoy buscando. 
	- Ante cualquier mÃ­nima duda preguntamela. 
	- No hace falta que ejecutes el prompt, ahora mismo, sÃ³lo tienes que centrarte en dejar claro lo que se desea.
	- Lo que te vaya solicitando, generamelo un bloque sin renderizar tus respuestas para que pueda copiar en un txt.
	
	Tarda lo que necesites y analizalo MUY BIEN y no escatimes en caracteres, puede ser todo lo extenso que quieras para que quede claro. 

---

# PROMPT TÃ‰CNICO COMPLETO â€“ GENERADOR DE MENÃšS SEMANALES EN PHP CON YAML

---

## ğŸ­ ROL QUE DEBE ASUMIR LA IA

Asume el rol de **Arquitecto de Software Web Senior y Desarrollador PHP Experto**, con amplia experiencia en:

- PHP sin frameworks obligatorios
- Aplicaciones web sin base de datos
- Uso de ficheros YAML como fuente de datos
- DiseÃ±o de lÃ³gica compleja de negocio
- UX clara y sin ambigÃ¼edades
- Accesibilidad WCAG 2.2
- Interfaces responsive (mÃ³vil y escritorio)
- JavaScript moderno (Fetch API, sin jQuery)
- GestiÃ³n de estado en cliente
- GeneraciÃ³n de PDFs en cliente
- CÃ³digo mantenible, robusto y bien estructurado

Debes pensar **como arquitecto**, no solo como programador.  
Prioriza claridad conceptual, coherencia de flujos y mantenibilidad.

---

## ğŸ§  CONTEXTO GENERAL DEL PROYECTO

Se desea construir una **aplicaciÃ³n web en PHP** para la **generaciÃ³n de menÃºs semanales (comida y cena)**.

### Principios fundamentales

- âŒ No usar base de datos
- âœ… Usar exclusivamente **ficheros YAML**
- âœ… Los YAML actÃºan como si fueran tablas relacionales
- âœ… La aplicaciÃ³n debe ser segura, simple y editable manualmente
- âœ… Todo el contenido se genera dinÃ¡micamente desde los YAML

---

## ğŸ—‚ï¸ MODELO DE DATOS (FUENTE ÃšNICA DE VERDAD)

Existen **tres ficheros YAML**:

- `Platos.yaml`
- `Recetas.yaml`
- `Ingredientes.yaml`

RelaciÃ³n lÃ³gica:

Plato (1) â†’ Receta (1) â†’ Ingredientes (N)

---

### ğŸ“„ Platos.yaml

Representa **platos finales consumibles**.  
Un plato puede ser internamente compuesto (ej. sopa + carne), pero **siempre se trata como una Ãºnica unidad** y **tiene una sola receta asociada**.

```yaml
Platos:
  - id: 1
    nombre: "Sopa de cocido + Filete de lomo"
    comida: true
    cena: false
    tipo: sopa
    Para_Eme: true
    Para_Cris: true
    id_receta: 1
```

Notas:
- `tipo` se usa para restricciones temporales
- `Para_Eme` y `Para_Cris` influyen en la lÃ³gica de emparejamiento
- No se guardan URLs aquÃ­, solo IDs

---

### ğŸ“„ Recetas.yaml

Describe **cÃ³mo se cocina el plato** y **quÃ© necesita**.

```yaml
Recetas:
  - id: 1
    Titulo_html: "Receta de Sopa de cocido + Filete de lomo"
    Subtitulo_html: "Plato tradicional completo"
    Texto_html: "<p>DescripciÃ³n completa de la receta en HTML...</p>"
    Ingredientes: [1, 2, 3, 4]
    Herramientas: ["olla", "sartÃ©n"]
    Enlace: "https://www.ejemplo.com/receta"
```

---

### ğŸ“„ Ingredientes.yaml

```yaml
Ingredientes:
  - id: 1
    nombre: "Filetes de lomo"
    calorias_x_100g: 250
    Supermercado: "CarnicerÃ­a"
```

---

## ğŸ§© ARQUITECTURA GENERAL

La aplicaciÃ³n consta de **dos ficheros PHP principales**:

1. `index.php` â†’ Generador de menÃºs
2. `receta.php` â†’ VisualizaciÃ³n de recetas

---

## ğŸ§ª index.php â€” GENERADOR DE MENÃšS

---

## ğŸ§  CONCEPTO CLAVE: DOS MENÃšS DIFERENCIADOS

### 1ï¸âƒ£ MENÃš TENTATIVO (GENERADO AUTOMÃTICAMENTE)

- Se genera al pulsar **Generar**
- Cumple **todas las restricciones**
- âŒ **NO permite platos repetidos**
- âŒ **NO es editable**
- âŒ **NO tiene checkboxes**
- ActÃºa como **origen / catÃ¡logo de selecciÃ³n**

---

### 2ï¸âƒ£ MENÃš EFECTIVO (CONSTRUIDO POR EL USUARIO)

- Se construye mediante interacciones del usuario
- âœ… **ES editable**
- âœ… **TIENE checkboxes**
- âœ… **PUEDE tener platos repetidos**
- Es el menÃº real que:
  - genera la lista de ingredientes
  - genera el PDF final

---

## ğŸ›ï¸ INTERFAZ DE USUARIO

1. **Selector mÃºltiple**
   - Etiqueta: `No contenga herramientas`
   - Opciones: herramientas Ãºnicas desde `Recetas.yaml`
   - Excluye recetas que usen cualquiera de las seleccionadas

2. **Input numÃ©rico**
   - Etiqueta: `DÃ­as`
   - Entero obligatorio
   - MÃ­nimo: 1
   - MÃ¡ximo: (total de platos / 2)

3. **BotÃ³n**
   - Texto: `Generar`

---

## ğŸ“Š TABLA DEL MENÃš TENTATIVO (SIN CHECKBOXES)

### Cabecera

```
NÂº | Comida | Para | Cena | Para
```

### Ejemplo de filas

```
1 | Sopa de cocido + Filete de lomo [Receta] | Eme<br/>Cris |
    SÃ¡ndwich mixto con huevo [Receta] | Eme

2 | Garbanzos con pisto [Receta] | Cris |
    Wrap de pollo [Receta] | Eme<br/>Cris
```

---

## ğŸ–±ï¸ INTERACCIÃ“N CON EL MENÃš TENTATIVO (CRÃTICO)

### ğŸ“Œ AcciÃ³n de AÃ‘ADIR

- **NO hay checkboxes**
- El usuario hace **click sobre la celda** de:
  - una comida
  - o una cena

#### Al hacer click:
- Se aÃ±ade el plato al **menÃº efectivo**
- Se coloca en:
  - el **primer hueco libre de comida** si es comida
  - el **primer hueco libre de cena** si es cena
- Se muestra un **alert visual agradable** indicando:
  - â€œComida aÃ±adidaâ€
  - o â€œCena aÃ±adidaâ€

---

## ğŸ“Š TABLA DEL MENÃš EFECTIVO (EDITABLE)

Esta tabla representa el menÃº real.

### Cabecera

```
DÃ­a | Comida | Quitar | Cena | Quitar
```

### Ejemplo

```
1 | Sopa de cocido + Filete de lomo | [âœ”] |
    Wrap de pollo | [âœ”]

2 | Garbanzos con pisto | [âœ”] |
    (vacÃ­o) |
```

---

## â˜‘ï¸ CHECKBOXES DEL MENÃš EFECTIVO

### Reglas IMPORTANTES

- Los **checkboxes SOLO EXISTEN AQUÃ**
- Representan:
  - â€œEste plato forma parte del menÃº efectivoâ€

### Al DESMARCAR un checkbox de COMIDA

- Esa comida:
  - se elimina del menÃº efectivo
  - deja su hueco libre
- El dÃ­a queda disponible para:
  - recibir otra comida desde el menÃº tentativo

### Al DESMARCAR un checkbox de CENA

- Esa cena:
  - se elimina del menÃº efectivo
  - deja su hueco libre
- El dÃ­a queda disponible para:
  - recibir otra cena desde el menÃº tentativo

---

## ğŸ” REGLAS DE REPETICIÃ“N

- MenÃº tentativo:
  - âŒ No permite repetidos
- MenÃº efectivo:
  - âœ… Permite repetidos sin restricciÃ³n

---

## ğŸ”„ LISTA DINÃMICA DE INGREDIENTES (AJAX)

- Refleja **EXCLUSIVAMENTE el menÃº efectivo**
- Se actualiza en tiempo real
- Usa Fetch API (JS nativo)

### Ejemplo

```
1 | Comida | Sopa de cocido + Filete de lomo |
  Â· Filetes de lomo
  Â· Caldo
  Â· Fideos
  Â· Sal
```

---

## ğŸ“„ PDF DE INGREDIENTES

Dos acciones separadas:

- **Vista Previa** â†’ abre PDF en nueva pestaÃ±a
- **Descargar** â†’ descarga directa

Contenido:
- Ingredientes Ãºnicos
- Ordenados por `Supermercado`

PDF generado **en cliente**.

---

## ğŸ³ receta.php â€” VISUALIZACIÃ“N DE RECETA

- Recibe `id`
- Lee `Recetas.yaml`
- Genera toda la estructura HTML desde PHP

Orden obligatorio:
1. Titulo_html (enlace externo, target="_blank")
2. Subtitulo_html
3. Texto_html
4. Ingredientes
5. Herramientas

---

## ğŸš¦ RESTRICCIONES DE GENERACIÃ“N (MENÃš TENTATIVO)

- No repetir platos salvo necesidad
- â‰¥ 4 dÃ­as entre pasta
- â‰¥ 9 dÃ­as entre fajitas
- â‰¥ 5 dÃ­as entre tortillas
- â‰¥ 5 dÃ­as entre cremas
- Al menos un pescado cada 7 dÃ­as

---

## ğŸ‘¥ LÃ“GICA DE PERSONAS (EME / CRIS)

- Si hay plato solo para Cris:
  - mantenerlo
  - aÃ±adir uno para Eme
- Prioridad:
  1. Para_X true / Para_Y false
  2. Ambos true
- LÃ³gica simÃ©trica

---

## â™¿ ACCESIBILIDAD

- WCAG 2.2 obligatorio
- NavegaciÃ³n por teclado
- Labels asociados
- Tablas accesibles
- Responsive mÃ³vil y escritorio

---

## ğŸ” RESTRICCIONES FINALES

- âŒ No base de datos
- âŒ No jQuery
- âŒ No frameworks obligatorios
- âœ… Validar YAML
- âœ… Manejar errores
- âœ… CÃ³digo claro y comentado

---

## ğŸ§  EXPECTATIVA FINAL

Este documento es una **especificaciÃ³n tÃ©cnica completa y cerrada**.  
No debe reinterpretarse, simplificarse ni ignorarse ninguna regla.

FIN DEL PROMPT


----------

1-El menÃº efectivo, solo en cliente (ya se generarÃ¡ el pdf si se quiere guardar.
2- Al pulsar generar se resetea el tentativo y se mantiene el efectivo
