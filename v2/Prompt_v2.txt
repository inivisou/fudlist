Te voy a pasar un prompt y despuÃ©s te irÃ© pidiendo cosas.

	- Analizalo minuciosamente para que te quede claro que es lo que estoy buscando. 
	- Ante cualquier mÃ­nima duda preguntamela. 
	- No hace falta que ejecutes el prompt, ahora mismo, sÃ³lo tienes que centrarte en dejar claro lo que se desea.
	- Lo que te vaya solicitando, generamelo un bloque sin renderizar tus respuestas para que pueda copiar en un txt.
	
	Tarda lo que necesites y analizalo MUY BIEN y no escatimes en caracteres, puede ser todo lo extenso que quieras para que quede claro. 

---

# PROMPT TÃ‰CNICO COMPLETO â€“ GENERADOR DE MENÃšS SEMANALES EN PHP CON JSON  
# (INGREDIENTES IDENTIFICADOS POR NOMBRE â€“ MENÃš TENTATIVO + MENÃš EFECTIVO)

---

## ğŸ­ ROL QUE DEBE ASUMIR LA IA

Asume el rol de **Arquitecto de Software Web Senior y Desarrollador PHP Experto**, con amplia experiencia en:

- PHP sin frameworks obligatorios
- Aplicaciones web sin base de datos
- Uso de ficheros JSON como fuente de datos
- DiseÃ±o de lÃ³gica compleja de negocio
- UX clara y sin ambigÃ¼edades
- Accesibilidad WCAG 2.2
- Interfaces responsive (mÃ³vil y escritorio)
- JavaScript moderno (Fetch API, sin jQuery)
- GestiÃ³n de estado exclusivamente en cliente
- GeneraciÃ³n de PDFs en cliente
- CÃ³digo mantenible, robusto y bien estructurado

Debes pensar **como arquitecto**, no solo como programador.  
Prioriza claridad conceptual, correcciÃ³n lÃ³gica, consistencia de datos y mantenibilidad.

---

## ğŸ§  CONTEXTO GENERAL DEL PROYECTO

Se desea construir una **aplicaciÃ³n web en PHP** para la **generaciÃ³n de menÃºs semanales (comida y cena)**.

### Principios fundamentales

- âŒ No usar base de datos
- âœ… Usar exclusivamente **ficheros JSON**
- âœ… Los JSON actÃºan como si fueran tablas relacionales
- âœ… La aplicaciÃ³n debe ser segura, simple y editable manualmente
- âœ… Todo el contenido se genera dinÃ¡micamente desde los JSON
- âœ… El **menÃº efectivo vive Ãºnicamente en cliente**
- âœ… La persistencia solo existe si el usuario genera un PDF

---

## ğŸ—‚ï¸ MODELO DE DATOS (FUENTE ÃšNICA DE VERDAD)

Existen **tres ficheros JSON**:

- `platos.json`
- `recetas.json`
- `ingredientes.json`

RelaciÃ³n lÃ³gica:

Plato (1) â†’ Receta (1) â†’ Ingredientes (N)

âš ï¸ **Los ingredientes se referencian por nombre**, no por ID.

---

## ğŸ“„ platos.json

```json
{
  "platos": [
    {
      "id": 1,
      "nombre": "Sopa de cocido + Filete de lomo",
      "comida": true,
      "cena": false,
      "tipo": "sopa",
      "para_eme": true,
      "para_cris": true,
      "id_receta": 1
    }
  ]
}
```

Reglas:
- Un plato **siempre tiene una Ãºnica receta**
- Puede ser internamente compuesto
- `tipo` se usa para restricciones temporales

---

## ğŸ“„ recetas.json

```json
{
  "recetas": [
    {
      "id": 1,
      "titulo_html": "Receta de Sopa de cocido + Filete de lomo",
      "subtitulo_html": "Plato tradicional completo",
      "texto_html": "<p>DescripciÃ³n completa de la receta en HTML...</p>",
      "ingredientes": [
        "Filetes de lomo",
        "Caldo de cocido",
        "Fideos",
        "Sal"
      ],
      "herramientas": ["olla", "sartÃ©n"],
      "enlace": "https://www.ejemplo.com/receta"
    }
  ]
}
```

---

## ğŸ“„ ingredientes.json

```json
{
  "ingredientes": [
    {
      "nombre": "Filetes de lomo",
      "calorias_x_100g": 250,
      "supermercado": "CarnicerÃ­a"
    },
    {
      "nombre": "Sal",
      "supermercado": "General"
    }
  ]
}
```

Reglas:
- `nombre` es **clave Ãºnica**
- Se usa para agrupar, ordenar y deduplicar ingredientes

---

## ğŸ§© RESOLUCIÃ“N DE INGREDIENTES

- Buscar por coincidencia exacta de nombre
- Si no existe en el catÃ¡logo:
  - se acepta igualmente
  - supermercado = `"Desconocido"`
- Nunca se rompe la ejecuciÃ³n

---

## ğŸ§  CONCEPTO CLAVE: DOS MENÃšS TOTALMENTE DIFERENCIADOS

### 1ï¸âƒ£ MENÃš TENTATIVO (GENERADO)

- Se genera al pulsar **Generar**
- Cumple **todas las restricciones**
- âŒ No repetidos
- âŒ No editable
- âŒ No tiene checkboxes
- Es **efÃ­mero**
- Se **resetea completamente** cada vez que se pulsa Generar

---

### 2ï¸âƒ£ MENÃš EFECTIVO (SELECCIONADO POR EL USUARIO)

- Vive **Ãºnicamente en cliente**
- âŒ No se guarda en servidor
- âŒ No persiste entre recargas
- âœ… Editable
- âœ… Puede contener repetidos
- âœ… Es la base para:
  - lista dinÃ¡mica de ingredientes
  - generaciÃ³n del PDF

âš ï¸ Al pulsar **Generar** de nuevo:
- el menÃº tentativo se reinicia
- el menÃº efectivo **SE MANTIENE INTACTO**

---

## ğŸ§ª index.php â€” GENERADOR DE MENÃšS

### ğŸ›ï¸ CONTROLES

1. **Selector mÃºltiple**
   - Texto: `No contenga herramientas`
   - Opciones: herramientas Ãºnicas de `recetas.json`
   - Excluye recetas con esas herramientas

2. **Input numÃ©rico**
   - Texto: `DÃ­as`
   - Entero obligatorio
   - MÃ­nimo: 1
   - MÃ¡ximo: total_platos / 2

3. **BotÃ³n**
   - Texto: `Generar`

---

## ğŸ“Š MENÃš TENTATIVO (TABLA NO EDITABLE)

```
NÂº | Comida | Para | Cena | Para
```

Ejemplo:

```
1 | Sopa de cocido + Filete de lomo [Receta] | Eme / Cris |
    SÃ¡ndwich mixto con huevo [Receta] | Eme
```

- No hay checkboxes
- Click sobre la **celda** aÃ±ade al menÃº efectivo

---

## ğŸ–±ï¸ INTERACCIÃ“N CON EL MENÃš TENTATIVO

- Click en celda de comida â†’ aÃ±adir comida
- Click en celda de cena â†’ aÃ±adir cena
- Se coloca en el **primer hueco libre**
- Mostrar alert visual:
  - â€œComida aÃ±adidaâ€
  - â€œCena aÃ±adidaâ€

---

## ğŸ“Š MENÃš EFECTIVO (TABLA EDITABLE â€“ SOLO CLIENTE)

Los dÃ­as son **nÃºmeros correlativos**, empezando en 1, sin fechas.

```
DÃ­a | Comida | Quitar | Cena | Quitar
```

### Ejemplo de MENÃš EFECTIVO

```
1 | Sopa de cocido + Filete de lomo | [âœ”] | Wrap de pollo | [âœ”]
2 | Garbanzos con pisto            | [âœ”] |              |
3 |                                |     | Tortilla francesa | [âœ”]
```

---

## â˜‘ï¸ CHECKBOXES DEL MENÃš EFECTIVO

- Solo existen en el menÃº efectivo
- Al desmarcar:
  - se elimina la comida o cena
  - el hueco queda libre
- El hueco puede volver a rellenarse desde el tentativo

---

## ğŸ”„ LISTA DINÃMICA DE INGREDIENTES (CLIENTE)

- Se actualiza en tiempo real (AJAX)
- Basada **solo en el menÃº efectivo**
- Ingredientes agrupados por nombre

Ejemplo:

```
DÃ­a 1 â€“ Comida
Â· Filetes de lomo
Â· Caldo de cocido
Â· Fideos
Â· Sal
```

---

## ğŸ“„ PDF DE INGREDIENTES

Dos opciones:

- **Vista previa** (nueva pestaÃ±a)
- **Descargar**

Contenido:
- Ingredientes Ãºnicos
- Ordenados por supermercado

---

## ğŸ³ receta.php â€” VISUALIZACIÃ“N DE RECETA

- Recibe `id`
- Lee `recetas.json`
- Renderiza:
  1. titulo_html (enlace externo, target="_blank")
  2. subtitulo_html
  3. texto_html
  4. lista de ingredientes
  5. lista de herramientas

Toda la estructura HTML la genera PHP.

---

## ğŸš¦ RESTRICCIONES DE GENERACIÃ“N (MENÃš TENTATIVO)

- No repetir platos salvo necesidad
- â‰¥ 4 dÃ­as entre pasta
- â‰¥ 9 dÃ­as entre fajitas
- â‰¥ 5 dÃ­as entre tortillas
- â‰¥ 5 dÃ­as entre cremas
- Al menos un pescado cada 7 dÃ­as

---

## ğŸ‘¥ LÃ“GICA DE PERSONAS (EME / CRIS)

- Mantener platos exclusivos
- AÃ±adir complemento si coincide el dÃ­a
- Prioridad:
  1. Exclusivo
  2. Compartido

---

## â™¿ ACCESIBILIDAD

- WCAG 2.2 obligatorio
- NavegaciÃ³n por teclado
- Tablas accesibles
- Responsive

---

## ğŸ” RESTRICCIONES FINALES

- âŒ No base de datos
- âŒ No jQuery
- âŒ No frameworks obligatorios
- âœ… Validar JSON
- âœ… Manejar errores
- âœ… CÃ³digo claro y comentado

---

## ğŸ§  EXPECTATIVA FINAL

Este documento es una **especificaciÃ³n tÃ©cnica completa, cerrada y no interpretable**.  
Debe implementarse tal cual se describe.

FIN DEL PROMPT
